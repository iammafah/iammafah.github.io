"use strict";function toggleActive(e){e&&e.classList.toggle("active")}function initSidebar(){const e=document.querySelector("[data-sidebar]"),t=document.querySelector("[data-sidebar-btn]");e&&t&&t.addEventListener("click",()=>{toggleActive(e)})}function initTestimonials(){const e=document.querySelectorAll("[data-testimonials-item]"),t=document.querySelector("[data-modal-container]"),a=document.querySelector("[data-modal-close-btn]"),n=document.querySelector("[data-overlay]"),o=document.querySelector("[data-modal-img]"),r=document.querySelector("[data-modal-title]"),i=document.querySelector("[data-modal-text]");function s(){t.classList.toggle("active"),n.classList.toggle("active")}t&&n&&(e.forEach(e=>{e.addEventListener("click",()=>{const t=e.querySelector("[data-testimonials-avatar]"),a=e.querySelector("[data-testimonials-title]"),n=e.querySelector("[data-testimonials-text]");t&&a&&n&&(o.src=t.src,o.alt=t.alt,r.innerHTML=a.innerHTML,i.innerHTML=n.innerHTML,s())})}),a&&a.addEventListener("click",s),n.addEventListener("click",s))}function initPortfolioFilter(){const e=document.querySelector("[data-select]"),t=document.querySelectorAll("[data-select-item]"),a=document.querySelector("[data-select-value]"),n=document.querySelectorAll("[data-filter-btn]"),o=document.querySelectorAll("[data-filter-item]");function r(e){o.forEach(t=>{"all"===e||t.dataset.category===e?t.classList.add("active"):t.classList.remove("active")})}e&&e.addEventListener("click",()=>toggleActive(e)),t.forEach(t=>{t.addEventListener("click",()=>{const n=t.innerText.toLowerCase();a&&(a.innerText=t.innerText),e.classList.remove("active"),r(n)})});let i=n[0];n.forEach(e=>{e.addEventListener("click",()=>{const t=e.innerText.toLowerCase();a&&(a.innerText=e.innerText),r(t),i&&i.classList.remove("active"),e.classList.add("active"),i=e})})}function initContactForm(){const e=document.querySelector("[data-form]"),t=document.querySelectorAll("[data-form-input]"),a=document.querySelector("[data-form-btn]"),n=document.querySelector("[data-form-status]");e&&a&&t.length&&(t.forEach(t=>{t.addEventListener("input",()=>{e.checkValidity()?a.removeAttribute("disabled"):a.setAttribute("disabled","")})}),e.addEventListener("submit",async t=>{t.preventDefault(),n.textContent="",a.setAttribute("disabled",""),a.querySelector("span").innerText="Sending...";const o=e.querySelector('[name="cf-turnstile-response"]'),r=o?o.value:null;if(!r)return n.textContent="Please complete verification.",n.className="form-status error",a.removeAttribute("disabled"),void(a.querySelector("span").innerText="Send Message");const i={FullName:e.fullname.value.trim(),Email:e.email.value.trim(),Message:e.message.value.trim(),token:r};try{const t=new AbortController;setTimeout(()=>t.abort(),3e4);const o=await fetch("https://socialcore-backend.onrender.com/iammafah/api/contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),signal:t.signal}),r=await o.json();if(!o.ok)throw new Error(r.error||"Failed to send message");n.textContent="Your message was sent successfully.",n.className="form-status success",e.reset(),window.turnstile&&turnstile.reset(),a.querySelector("span").innerText="Send Message",a.setAttribute("disabled","")}catch(e){n.textContent=e.message,n.className="form-status error",a.querySelector("span").innerText="Send Message",a.removeAttribute("disabled")}}))}async function loadLayout(){const e=window.BASE_PATH||".";try{const t=document.getElementById("header");if(t){const a=await fetch(`${e}/partials/header.html`);t.innerHTML=await a.text(),"function"==typeof initSidebar&&initSidebar()}const a=document.getElementById("footer");if(a){const t=await fetch(`${e}/partials/footer.html`);a.innerHTML=await t.text()}}catch(e){console.error("Layout load failed:",e)}}document.addEventListener("DOMContentLoaded",()=>{loadLayout(),initSidebar(),initTestimonials(),initPortfolioFilter(),initContactForm()});